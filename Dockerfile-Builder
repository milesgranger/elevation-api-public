FROM debian:jessie-slim

RUN apt update && apt install -y \
    libnetcdf-dev \
    curl \
    gcc \
    g++

# build passes --build-arg DONTCACHE=$(date) to keep the steps below from being cached
ARG DONTCACHE=1

# Install rust nightly
RUN curl https://sh.rustup.rs -sSf | sh -s -- --default-toolchain nightly -y
RUN bash -c "source $HOME/.cargo/env"
ENV PATH=$HOME/.cargo/bin:$PATH

WORKDIR /build

CMD $HOME/.cargo/bin/cargo build --release
